<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Jogo da Cobrinha</title>
<style>
  body {
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background:black;
    color:white;
    display:flex;
    flex-direction:column;
    align-items:center;
  }
  h1 {
    font-size:3rem;
    color:#00ff00;
    text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00;
    margin-top:20px;
    animation: glow 1.5s infinite alternate;
  }
  @keyframes glow {
    from { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00; }
    to { text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; }
  }
  #modeSelection, #soloSetup, #duoSetup, #gameContainer, #gameOverScreen {
    display:none;
    margin-top:20px;
    text-align:center;
  }
  .btn {
    background:linear-gradient(90deg,#1e90ff,#4fc3f7);
    border:none;
    color:white;
    padding:12px 20px;
    margin:8px;
    font-size:1rem;
    font-weight:bold;
    border-radius:12px;
    cursor:pointer;
    transition:0.2s;
  }
  .btn:hover {
    transform:translateY(-3px);
    box-shadow:0 8px 20px rgba(30,144,255,0.4);
  }
  input {
    padding:8px;
    margin:6px;
    border-radius:8px;
    border:none;
    font-size:1rem;
  }
  canvas {
    background:black;
    border:3px solid white;
    display:block;
    margin:20px auto;
  }
  #leaderboard {
    width:200px;
    background:#111;
    border:2px solid #00bfff;
    color:white;
    padding:10px;
    margin-left:20px;
    float:right;
  }
  .leaderboard-title { font-weight:bold; margin-bottom:8px; text-align:center; }
</style>
</head>
<body>
<h1>Jogo da Cobrinha üêç</h1>

<!-- Tela de sele√ß√£o de modos -->
<div id="modeSelection">
  <button class="btn" id="soloBtn">Solo</button>
  <button class="btn" id="duoBtn">1 vs 1</button>
  <br>
  <button class="btn" id="backHomeBtn">üè† Voltar para p√°gina inicial</button>
</div>

<!-- Solo setup -->
<div id="soloSetup">
  <p>Digite seu nome e sala:</p>
  <input type="text" id="soloName" placeholder="Seu nome">
  <input type="text" id="soloRoom" placeholder="Sala">
  <br>
  <button class="btn" id="startSoloBtn">JOGAR üéÆ</button>
  <button class="btn" id="cancelSoloBtn">Cancelar ‚ùå</button>
</div>

<!-- Duo setup -->
<div id="duoSetup">
  <p>Jogador 1:</p>
  <input type="text" id="duoName1" placeholder="Nome 1">
  <p>Jogador 2:</p>
  <input type="text" id="duoName2" placeholder="Nome 2">
  <p>Sala:</p>
  <input type="text" id="duoRoom" placeholder="Sala">
  <br>
  <button class="btn" id="startDuoBtn">JOGAR üéÆ</button>
  <button class="btn" id="cancelDuoBtn">Cancelar ‚ùå</button>
</div>

<!-- Container do jogo -->
<div id="gameContainer">
  <canvas id="gameCanvas" width="600" height="400"></canvas>
  <div id="leaderboard">
    <div class="leaderboard-title">üèÜ Leaderboard</div>
    <ul id="scoresList"></ul>
  </div>
  <br>
  <button class="btn" id="exitGameBtn">Sair do minigame ‚ùå</button>
</div>

<!-- Tela de morte/vit√≥ria -->
<div id="gameOverScreen">
  <h2 id="gameOverText"></h2>
  <button class="btn" id="restartBtn">Recome√ßar üîÑ</button>
  <button class="btn" id="exitToModeBtn">Sair do minigame ‚ùå</button>
</div>

<script>
let soloMode = false;
let duoMode = false;
let playerName, playerRoom;
let gameInterval;
let canvas = document.getElementById("gameCanvas");
let ctx = canvas.getContext("2d");
let snake = [], food;
let dx=20, dy=0, score=0;
let moveSound = new Audio("https://www.soundjay.com/button/beep-07.wav");
let eatSound = new Audio("https://www.soundjay.com/button/button-3.wav");
let leaderboard = JSON.parse(localStorage.getItem("snakeLeaderboard")) || [];

const show = (id) => {
  ["modeSelection","soloSetup","duoSetup","gameContainer","gameOverScreen"].forEach(el=>{
    document.getElementById(el).style.display="none";
  });
  document.getElementById(id).style.display="block";
}

// Inicial
show("modeSelection");

// Bot√µes modos
document.getElementById("soloBtn").onclick = ()=>{ soloMode=true; show("soloSetup"); }
document.getElementById("duoBtn").onclick = ()=>{ duoMode=true; show("duoSetup"); }
document.getElementById("backHomeBtn").onclick = ()=>{ window.location.href="index.html"; }

// Cancelar
document.getElementById("cancelSoloBtn").onclick = ()=>{ soloMode=false; show("modeSelection"); }
document.getElementById("cancelDuoBtn").onclick = ()=>{ duoMode=false; show("modeSelection"); }
document.getElementById("exitGameBtn").onclick = ()=>{ clearInterval(gameInterval); show("modeSelection"); }
document.getElementById("exitToModeBtn").onclick = ()=>{ show("modeSelection"); }

// Start Solo
document.getElementById("startSoloBtn").onclick = ()=>{
  playerName=document.getElementById("soloName").value.trim();
  playerRoom=document.getElementById("soloRoom").value.trim();
  if(!playerName || !playerRoom){ alert("Preencha todas as informa√ß√µes!"); return; }
  startGame();
}

// Start Duo
document.getElementById("startDuoBtn").onclick = ()=>{
  playerName=document.getElementById("duoName1").value.trim();
  playerRoom=document.getElementById("duoRoom").value.trim();
  if(!playerName || !playerRoom){ alert("Preencha todas as informa√ß√µes!"); return; }
  startGame(); // Aqui implementa depois os dois jogadores
}

// Fun√ß√£o inicial do jogo
function startGame(){
  show("gameContainer");
  snake=[{x:300,y:200}];
  dx=20; dy=0;
  score=0;
  spawnFood();
  document.addEventListener("keydown",changeDirection);
  gameInterval = setInterval(gameLoop,100);
  updateLeaderboard();
}

// Fun√ß√µes do jogo
function spawnFood(){
  food={x:Math.floor(Math.random()*30)*20, y:Math.floor(Math.random()*20)*20};
}

function changeDirection(e){
  moveSound.play();
  switch(e.key){
    case "ArrowUp": if(dy===0){dx=0; dy=-20;} break;
    case "ArrowDown": if(dy===0){dx=0; dy=20;} break;
    case "ArrowLeft": if(dx===0){dx=-20; dy=0;} break;
    case "ArrowRight": if(dx===0){dx=20; dy=0;} break;
  }
}

function gameLoop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  snake.forEach((seg)=>{ ctx.fillStyle="lime"; ctx.fillRect(seg.x,seg.y,20,20); ctx.strokeStyle="white"; ctx.strokeRect(seg.x,seg.y,20,20); });
  ctx.fillStyle="red";
  ctx.fillRect(food.x,food.y,20,20);
  
  let head = {x: snake[0].x + dx, y: snake[0].y + dy};
  
  // Colis√£o paredes
  if(head.x<0||head.x>=canvas.width||head.y<0||head.y>=canvas.height||snakeCollision(head)){
    endGame("Voc√™ MORREU! ‚ò†Ô∏è");
    return;
  }
  
  snake.unshift(head);
  
  // Comer ma√ß√£
  if(head.x===food.x && head.y===food.y){
    eatSound.play();
    score+=10;
    spawnFood();
  } else {
    snake.pop();
  }
}

// Checar colis√£o com corpo
function snakeCollision(head){
  for(let i=1;i<snake.length;i++){
    if(snake[i].x===head.x && snake[i].y===head.y) return true;
  }
  return false;
}

// Tela fim de jogo
function endGame(msg){
  clearInterval(gameInterval);
  document.getElementById("gameOverText").innerText=msg+"\nPontua√ß√£o: "+score+" ("+playerName+")";
  leaderboard.push({name:playerName,score:score});
  localStorage.setItem("snakeLeaderboard",JSON.stringify(leaderboard));
  updateLeaderboard();
  show("gameOverScreen");
}

// Atualiza leaderboard
function updateLeaderboard(){
  let ul=document.getElementById("scoresList");
  ul.innerHTML="";
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard.forEach(entry=>{
    let li=document.createElement("li");
    li.innerText=`${entry.name}: ${entry.score}`;
    ul.appendChild(li);
  });
}

// Bot√£o recome√ßar
document.getElementById("restartBtn").onclick = ()=>{ startGame(); }
</script>
</body>
</html>
