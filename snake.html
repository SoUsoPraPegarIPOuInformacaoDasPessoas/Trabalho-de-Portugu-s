<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Cobrinha ‚Äî Matheus M√°ximo & Marcos Guilherme</title>
<style>
  body {
    margin: 0;
    background-color: #000; /* fundo preto */
    font-family: 'Segoe UI', sans-serif;
    color: #0f0;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
  }

  h1 {
    font-size: 3rem;
    margin-top: 20px;
    color: #0f0;
    text-shadow: 2px 2px #fff;
    animation: pulse 1s infinite;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  #modeSelection, #soloSetup, #versusSetup, #gameOverScreen {
    margin-top: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .btn {
    padding: 12px 25px;
    border-radius: 12px;
    border: none;
    background: linear-gradient(90deg, #0f0, #0a0);
    color: #000;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 15px rgba(0,255,0,0.5);
  }

  canvas {
    border: 3px solid #0ff;
    background-color: #111;
    margin-top: 20px;
  }

  .inputField {
    padding: 10px;
    border-radius: 10px;
    border: 2px solid #0ff;
    background: #111;
    color: #0f0;
    font-size: 1rem;
  }

  #leaderboard {
    position: absolute;
    top: 100px;
    right: 20px;
    width: 220px;
    background: orange;
    border: 3px solid blue;
    padding: 12px;
    border-radius: 12px;
    color: black;
  }

  #gameOverScreen {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(255,0,0,0.95);
    color: white;
    display: none;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    gap: 20px;
    z-index: 10;
  }

</style>
</head>
<body>

<h1>üü¢ Jogo da Cobrinha üü¢</h1>

<div id="modeSelection">
  <button class="btn" id="soloBtn">Solo üêç</button>
  <button class="btn" id="versusBtn">1 vs 1 ‚öîÔ∏è</button>
</div>

<!-- SOLO SETUP -->
<div id="soloSetup" style="display:none;">
  <input class="inputField" id="soloName" placeholder="Seu nome">
  <input class="inputField" id="soloRoom" placeholder="Sala">
  <button class="btn" id="startSoloBtn">JOGAR üü¢</button>
  <button class="btn" id="cancelSoloBtn">Sair ‚ùå</button>
</div>

<!-- VERSUS SETUP -->
<div id="versusSetup" style="display:none;">
  <input class="inputField" id="player1Name" placeholder="Jogador 1">
  <input class="inputField" id="player2Name" placeholder="Jogador 2">
  <input class="inputField" id="versusRoom" placeholder="Sala">
  <button class="btn" id="startVersusBtn">JOGAR üü¢</button>
  <button class="btn" id="cancelVersusBtn">Sair ‚ùå</button>
</div>

<canvas id="gameCanvas" width="600" height="400" style="display:none;"></canvas>
<div id="leaderboard"></div>

<div id="gameOverScreen">
  <div id="gameOverText"></div>
  <button class="btn" id="restartBtn">Recome√ßar üîÑ</button>
  <button class="btn" id="exitBtn">Sair ‚ùå</button>
</div>

<audio id="eatSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="moveSound" src="https://www.soundjay.com/button/beep-05.wav"></audio>

<script>
  const modeSelection = document.getElementById('modeSelection');
  const soloSetup = document.getElementById('soloSetup');
  const versusSetup = document.getElementById('versusSetup');
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const leaderboardDiv = document.getElementById('leaderboard');
  const gameOverScreen = document.getElementById('gameOverScreen');
  const gameOverText = document.getElementById('gameOverText');
  const eatSound = document.getElementById('eatSound');
  const moveSound = document.getElementById('moveSound');

  let gameInterval;
  let snake, food, direction, score;
  let gameMode = ''; // 'solo' ou 'versus'
  let playerName = '';
  let roomName = '';

  // === LEADERBOARD ===
  let leaderboard = JSON.parse(localStorage.getItem('snakeLeaderboard')) || [];

  function updateLeaderboard() {
    let html = '<strong>üèÜ Leaderboard</strong><br>';
    leaderboard.forEach(item => {
      html += `${item.name} (Sala: ${item.room}) - ${item.score}<br>`;
    });
    leaderboardDiv.innerHTML = html;
  }
  updateLeaderboard();

  // === MODE BUTTONS ===
  document.getElementById('soloBtn').onclick = () => {
    modeSelection.style.display = 'none';
    soloSetup.style.display = 'flex';
    canvas.style.display = 'none';
  };

  document.getElementById('versusBtn').onclick = () => {
    modeSelection.style.display = 'none';
    versusSetup.style.display = 'flex';
    canvas.style.display = 'none';
  };

  // === CANCEL BUTTONS ===
  document.getElementById('cancelSoloBtn').onclick = () => {
    soloSetup.style.display = 'none';
    modeSelection.style.display = 'flex';
  };

  document.getElementById('cancelVersusBtn').onclick = () => {
    versusSetup.style.display = 'none';
    modeSelection.style.display = 'flex';
  };

  // === START SOLO ===
  document.getElementById('startSoloBtn').onclick = () => {
    const name = document.getElementById('soloName').value.trim();
    const room = document.getElementById('soloRoom').value.trim();
    if(!name || !room){
      alert('Preencha seu nome e a sala!');
      return;
    }
    playerName = name;
    roomName = room;
    gameMode = 'solo';
    soloSetup.style.display = 'none';
    canvas.style.display = 'block';
    startGame();
  };

  function startGame(){
    snake = [{x:10, y:10}];
    food = {x: Math.floor(Math.random()*30), y: Math.floor(Math.random()*20)};
    direction = 'RIGHT';
    score = 0;

    document.addEventListener('keydown', changeDirection);

    clearInterval(gameInterval);
    gameInterval = setInterval(gameLoop, 100);
  }

  function changeDirection(e){
    moveSound.play();
    if(e.key === 'ArrowUp' && direction !== 'DOWN') direction = 'UP';
    else if(e.key === 'ArrowDown' && direction !== 'UP') direction = 'DOWN';
    else if(e.key === 'ArrowLeft' && direction !== 'RIGHT') direction = 'LEFT';
    else if(e.key === 'ArrowRight' && direction !== 'LEFT') direction = 'RIGHT';
  }

  function gameLoop(){
    // move snake
    let head = {...snake[0]};
    if(direction==='UP') head.y--;
    if(direction==='DOWN') head.y++;
    if(direction==='LEFT') head.x--;
    if(direction==='RIGHT') head.x++;

    // wall collision
    if(head.x<0 || head.x>=30 || head.y<0 || head.y>=20 || snake.some(s=>s.x===head.x && s.y===head.y)){
      endGame('Voc√™ Morreu! üíÄ');
      return;
    }

    snake.unshift(head);

    // eat food
    if(head.x===food.x && head.y===food.y){
      score++;
      eatSound.play();
      food = {x: Math.floor(Math.random()*30), y: Math.floor(Math.random()*20)};
    } else {
      snake.pop();
    }

    // draw
    ctx.fillStyle = '#111';
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // draw snake
    ctx.fillStyle = '#0f0';
    snake.forEach(s=>{
      ctx.fillRect(s.x*20, s.y*20, 20, 20);
    });

    // draw food
    ctx.fillStyle = '#f00';
    ctx.fillRect(food.x*20, food.y*20, 20, 20);
  }

  function endGame(text){
    clearInterval(gameInterval);
    gameOverText.innerHTML = `${text}<br>Pontua√ß√£o: ${score}<br>Nome: ${playerName}<br>Sala: ${roomName}`;
    gameOverScreen.style.display = 'flex';
    // add to leaderboard
    leaderboard.push({name: playerName, room: roomName, score});
    leaderboard.sort((a,b)=>b.score-a.score);
    localStorage.setItem('snakeLeaderboard', JSON.stringify(leaderboard));
    updateLeaderboard();
  }

  // === RESTART AND EXIT BUTTONS ===
  document.getElementById('restartBtn').onclick = () => {
    gameOverScreen.style.display = 'none';
    startGame();
  };

  document.getElementById('exitBtn').onclick = () => {
    gameOverScreen.style.display = 'none';
    canvas.style.display = 'none';
    modeSelection.style.display = 'flex';
  };

</script>
</body>
</html>
