<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Cobrinha ğŸ</title>
<style>
:root{
  --green:#00ff00; --white:#fff; --black:#000; --blue:#1e90ff; --orange:#ffa500;
}
body{
  margin:0;
  font-family:"Segoe UI", Roboto, Arial, sans-serif;
  background: var(--black);
  color: var(--white);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:flex-start;
}
h1{
  color:var(--green);
  font-size:3rem;
  text-align:center;
  margin-top:20px;
  border:4px solid var(--white);
  padding:10px 20px;
  border-radius:12px;
}
#menu, #soloMenu, #multiMenu, #gameContainer, #gameOver, #gameWin{
  margin-top:20px;
  text-align:center;
}
button{
  padding:10px 18px;
  margin:6px;
  border-radius:12px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  font-size:1rem;
  transition:0.2s;
}
button:hover{
  transform:translateY(-3px);
  box-shadow:0 6px 20px rgba(0,255,0,0.3);
}
#gameCanvas{
  background:#111;
  margin-top:20px;
  display:block;
}
#leaderboard{
  position:absolute;
  top:100px;
  right:20px;
  width:220px;
  background:var(--orange);
  border:4px solid var(--blue);
  border-radius:12px;
  padding:10px;
  color:black;
}
.inputField{
  margin:8px;
  padding:8px;
  border-radius:8px;
  border:none;
}
.hidden{display:none;}
</style>
</head>
<body>

<h1>Jogo da Cobrinha ğŸ</h1>

<!-- Tela Inicial: Solo ou 1vs1 -->
<div id="menu">
  <button id="soloBtn">Solo ğŸŸ¢</button>
  <button id="multiBtn">1 vs 1 ğŸ”µ</button>
</div>

<!-- Solo: Nome e Sala -->
<div id="soloMenu" class="hidden">
  <p>Coloque seu Nome e Sala</p>
  <input type="text" id="soloName" class="inputField" placeholder="Seu Nome">
  <input type="text" id="soloRoom" class="inputField" placeholder="Sala">
  <br>
  <button id="soloStart">JOGAR â–¶ï¸</button>
  <button id="soloBack">Voltar â¬…ï¸</button>
</div>

<!-- 1 vs 1: Nomes e Sala -->
<div id="multiMenu" class="hidden">
  <p>Coloque os Nomes e Sala</p>
  <input type="text" id="player1Name" class="inputField" placeholder="Jogador 1">
  <input type="text" id="player2Name" class="inputField" placeholder="Jogador 2">
  <input type="text" id="multiRoom" class="inputField" placeholder="Sala">
  <br>
  <button id="multiStart">JOGAR â–¶ï¸</button>
  <button id="multiBack">Voltar â¬…ï¸</button>
</div>

<!-- Canvas do Jogo -->
<div id="gameContainer" class="hidden">
  <canvas id="gameCanvas" width="600" height="400"></canvas>
  <div class="botoes">
    <button id="restartBtn">RecomeÃ§ar ğŸ”„</button>
    <button id="exitBtn">Sair âŒ</button>
  </div>
</div>

<!-- Tela de Game Over -->
<div id="gameOver" class="hidden">
  <h2 style="color:red;">VOCÃŠ MORREU! ğŸ’€</h2>
  <button id="restartOver">RecomeÃ§ar ğŸ”„</button>
  <button id="exitOver">Sair âŒ</button>
</div>

<!-- Tela de VitÃ³ria -->
<div id="gameWin" class="hidden">
  <h2 style="color:lime;">VOCÃŠ GANHOU! ğŸ†</h2>
  <button id="restartWin">RecomeÃ§ar ğŸ”„</button>
  <button id="exitWin">Sair âŒ</button>
</div>

<!-- Leaderboard -->
<div id="leaderboard">
  <h3>Leaderboard ğŸ…</h3>
  <ul id="scoresList"></ul>
</div>

<audio id="eatSound" src="https://www.soundjay.com/button/beep-07.wav"></audio>
<audio id="moveSound" src="https://www.soundjay.com/button/button-3.mp3"></audio>

<script>
// ==================== VariÃ¡veis Globais =====================
let canvas = document.getElementById("gameCanvas");
let ctx = canvas.getContext("2d");
let boardWidth = canvas.width;
let boardHeight = canvas.height;
let tileSize = 20;
let snake = [];
let food = {};
let direction = null;
let gameInterval = null;
let score = 0;
let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];

// Sons
let eatSound = document.getElementById("eatSound");
let moveSound = document.getElementById("moveSound");

// ==================== FunÃ§Ãµes ==============================
function drawBoard(){
  ctx.fillStyle="#111";
  ctx.fillRect(0,0,boardWidth,boardHeight);
}
function drawSnake(){
  ctx.fillStyle="lime";
  snake.forEach(part => ctx.fillRect(part.x, part.y, tileSize, tileSize));
}
function drawFood(){
  ctx.fillStyle="red";
  ctx.fillRect(food.x, food.y, tileSize, tileSize);
}
function placeFood(){
  food.x = Math.floor(Math.random()*(boardWidth/tileSize))*tileSize;
  food.y = Math.floor(Math.random()*(boardHeight/tileSize))*tileSize;
}
function initSnake(){
  snake = [{x:200, y:200}];
  direction = null;
  score=0;
  placeFood();
}
function moveSnake(){
  let head = {...snake[0]};
  if(direction=="up") head.y -= tileSize;
  if(direction=="down") head.y += tileSize;
  if(direction=="left") head.x -= tileSize;
  if(direction=="right") head.x += tileSize;

  // Verifica colisÃ£o paredes
  if(head.x<0 || head.x>=boardWidth || head.y<0 || head.y>=boardHeight){
    gameOver();
    return;
  }
  // Verifica colisÃ£o com corpo
  if(snake.some(part=>part.x===head.x && part.y===head.y)){
    gameOver();
    return;
  }

  snake.unshift(head);
  // Verifica comida
  if(head.x===food.x && head.y===food.y){
    score++;
    eatSound.play();
    placeFood();
  }else{
    snake.pop();
  }
}

// ==================== Game Loop ===========================
function gameLoop(){
  drawBoard();
  drawFood();
  drawSnake();
}
function startGame(){
  initSnake();
  clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop,150);
}

// ==================== Eventos =============================
document.addEventListener("keydown",e=>{
  if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)){
    moveSound.play();
  }
  if(e.key=="ArrowUp" && direction!="down") direction="up";
  if(e.key=="ArrowDown" && direction!="up") direction="down";
  if(e.key=="ArrowLeft" && direction!="right") direction="left";
  if(e.key=="ArrowRight" && direction!="left") direction="right";
});

// ==================== Game Over ===========================
function gameOver(){
  clearInterval(gameInterval);
  saveScore();
  document.getElementById("gameContainer").classList.add("hidden");
  document.getElementById("gameOver").classList.remove("hidden");
}
function saveScore(){
  let name = document.getElementById("soloName")?.value || "Player";
  leaderboard.push({name:name, score:score});
  leaderboard.sort((a,b)=>b.score-a.score);
  localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
  updateLeaderboard();
}
function updateLeaderboard(){
  let list = document.getElementById("scoresList");
  list.innerHTML="";
  leaderboard.forEach(entry=>{
    let li = document.createElement("li");
    li.textContent = `${entry.name}: ${entry.score}`;
    list.appendChild(li);
  });
}

// ==================== BotÃµes =============================
document.getElementById("soloBtn").onclick = ()=>{
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("soloMenu").classList.remove("hidden");
};
document.getElementById("multiBtn").onclick = ()=>{
  document.getElementById("menu").classList.add("hidden");
  document.getElementById("multiMenu").classList.remove("hidden");
};
document.getElementById("soloBack").onclick = ()=>{
  document.getElementById("soloMenu").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
};
document.getElementById("multiBack").onclick = ()=>{
  document.getElementById("multiMenu").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
};
document.getElementById("soloStart").onclick = ()=>{
  let name=document.getElementById("soloName").value.trim();
  let room=document.getElementById("soloRoom").value.trim();
  if(!name || !room){alert("Preencha Nome e Sala!"); return;}
  document.getElementById("soloMenu").classList.add("hidden");
  document.getElementById("gameContainer").classList.remove("hidden");
  startGame();
};
document.getElementById("restartBtn").onclick = startGame;
document.getElementById("exitBtn").onclick = ()=>{
  clearInterval(gameInterval);
  document.getElementById("gameContainer").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
};
document.getElementById("restartOver").onclick = ()=>{
  document.getElementById("gameOver").classList.add("hidden");
  document.getElementById("gameContainer").classList.remove("hidden");
  startGame();
};
document.getElementById("exitOver").onclick = ()=>{
  document.getElementById("gameOver").classList.add("hidden");
  document.getElementById("menu").classList.remove("hidden");
};
updateLeaderboard();
</script>

</body>
</html>
