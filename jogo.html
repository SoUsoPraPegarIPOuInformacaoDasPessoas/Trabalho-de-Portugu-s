<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Cobrinha ‚Äî Bacon News</title>
<style>
  body {
    margin:0;
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    background-color: #0a1d3f; /* Azul escuro */
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    color:white;
  }
  #gameContainer {
    position:relative;
    margin-top:20px;
  }
  canvas {
    background-color:#001a4d; /* Azul mais claro para o canvas */
    display:block;
    margin:auto;
    border:4px solid #87ceeb; /* borda azul beb√™ */
    border-radius:12px;
  }
  #leaderboardBtn {
    margin-top:12px;
    padding:10px 16px;
    background:linear-gradient(90deg,#06b6d4,#0ea5e9);
    color:white;
    border:none;
    border-radius:12px;
    cursor:pointer;
    font-weight:700;
    font-size:1rem;
  }
  #leaderboardFrame {
    position:absolute;
    top:60px;
    left:50%;
    transform:translateX(-50%) scaleY(0);
    transform-origin:top;
    transition: transform 0.3s ease;
    width:300px;
    background:#ffa500; /* laranja */
    border:3px solid #87ceeb; /* azul beb√™ */
    border-radius:12px;
    padding:12px;
    color:#000;
    z-index:100;
  }
  #leaderboardFrame h3 {
    margin:0 0 8px 0;
    text-align:center;
  }
  #leaderboardFrame ul {
    list-style:none;
    padding:0;
    margin:0;
  }
  #leaderboardFrame li {
    margin-bottom:4px;
  }
</style>
</head>
<body>
<h1>üêç Jogo da Cobrinha ‚Äî Bacon News</h1>

<div id="gameContainer">
  <canvas id="gameCanvas" width="400" height="400"></canvas>
  <div id="leaderboardFrame">
    <h3>üèÜ Leaderboard</h3>
    <ul id="leaderboardList"></ul>
  </div>
  <button id="leaderboardBtn">üìã Ver Pontua√ß√µes</button>
</div>

<audio id="eatSound" src="https://freesound.org/data/previews/341/341695_6244162-lq.mp3"></audio>
<audio id="moveSound" src="https://freesound.org/data/previews/256/256113_4486188-lq.mp3"></audio>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const leaderboardBtn = document.getElementById("leaderboardBtn");
  const leaderboardFrame = document.getElementById("leaderboardFrame");
  const leaderboardList = document.getElementById("leaderboardList");
  const eatSound = document.getElementById("eatSound");
  const moveSound = document.getElementById("moveSound");

  let snake = [{x:10, y:10}];
  let food = {x:5, y:5};
  let dx=1, dy=0;
  let grid=20;
  let speed=200;
  let score=0;
  let playerName = prompt("Digite seu nome:");
  let room = prompt("Digite sua sala:");
  let gameOver = false;
  let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];

  function draw() {
    ctx.fillStyle = "#001a4d"; // fundo do canvas
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // desenhar comida
    ctx.fillStyle = "red";
    ctx.fillRect(food.x*grid, food.y*grid, grid, grid);

    // desenhar cobra
    ctx.fillStyle = "lime";
    snake.forEach(segment => {
      ctx.fillRect(segment.x*grid, segment.y*grid, grid-2, grid-2);
    });
  }

  function update() {
    if(gameOver) return;

    let head = {x: snake[0].x + dx, y: snake[0].y + dy};

    // colis√£o com parede
    if(head.x < 0 || head.x >= canvas.width/grid || head.y < 0 || head.y >= canvas.height/grid) {
      endGame();
      return;
    }

    // colis√£o consigo mesmo
    for(let segment of snake){
      if(segment.x===head.x && segment.y===head.y){
        endGame();
        return;
      }
    }

    snake.unshift(head);

    // comer ma√ß√£
    if(head.x===food.x && head.y===food.y){
      score++;
      eatSound.play();
      placeFood();
    } else {
      snake.pop();
    }

    draw();
  }

  function placeFood() {
    food.x = Math.floor(Math.random() * canvas.width/grid);
    food.y = Math.floor(Math.random() * canvas.height/grid);
  }

  function endGame() {
    gameOver = true;
    leaderboard.push({name:playerName, room:room, score:score});
    localStorage.setItem("leaderboard", JSON.stringify(leaderboard));
    alert(`üíÄ VOC√ä MORREU!\nPontua√ß√£o: ${score}`);
    if(confirm("Quer recome√ßar?")){
      location.reload();
    }
  }

  function gameLoop() {
    update();
    setTimeout(gameLoop, speed);
  }

  document.addEventListener("keydown", (e)=>{
    if(e.key==="ArrowUp" && dy===0){dx=0; dy=-1; moveSound.play();}
    if(e.key==="ArrowDown" && dy===0){dx=0; dy=1; moveSound.play();}
    if(e.key==="ArrowLeft" && dx===0){dx=-1; dy=0; moveSound.play();}
    if(e.key==="ArrowRight" && dx===0){dx=1; dy=0; moveSound.play();}
  });

  // bot√£o leaderboard
  leaderboardBtn.addEventListener("click", ()=>{
    if(leaderboardFrame.style.transform==="translateX(-50%) scaleY(1)"){
      leaderboardFrame.style.transform="translateX(-50%) scaleY(0)";
    } else {
      updateLeaderboard();
      leaderboardFrame.style.transform="translateX(-50%) scaleY(1)";
    }
  });

  function updateLeaderboard() {
    leaderboardList.innerHTML = "";
    leaderboard.sort((a,b)=>b.score-a.score);
    leaderboard.forEach(entry=>{
      let li = document.createElement("li");
      li.textContent = `${entry.name} (Sala ${entry.room}) ‚Üí ${entry.score} pts`;
      leaderboardList.appendChild(li);
    });
  }

  placeFood();
  draw();
  setTimeout(gameLoop, speed);
</script>
</body>
</html>
